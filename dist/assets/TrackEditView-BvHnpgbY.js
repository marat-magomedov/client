import{d as A,u as G,l as B,h as w,n as F,y as I,x as D,c as i,b as s,a as r,i as h,f as l,t as y,j as _,k as p,v as b,w as n,r as M,g as m,T as V,q as T,F as E,p as R,s as N,o as d}from"./index-DT03jyhA.js";import{u as L,r as S}from"./tracks-C4xg7Mxt.js";import{_ as H,c as J}from"./Footer.vue_vue_type_script_setup_true_lang-Bm2BFVvq.js";import{r as j}from"./ArrowPathIcon-C-Ojjxoq.js";import{I as K,j as O,r as P,A as Q,F as q}from"./listbox-CfzWbYyL.js";import{r as W}from"./CheckIcon-qmlbtpli.js";import"./SunIcon-DNKNajIN.js";import"./CurrencyDollarIcon-CsVrdL4t.js";const X={class:"min-h-screen bg-light-bg dark:bg-gray-900 flex flex-col"},Y={class:"flex-1 container mx-auto px-4 py-8 md:py-12"},Z={class:"max-w-4xl mx-auto"},ee={key:0,class:"text-center p-8 bg-light-bg-secondary dark:bg-gray-800/40 rounded-2xl border border-light-border dark:border-gray-700/30"},re={class:"inline-flex items-center gap-3 text-light-text-secondary dark:text-gray-400"},te={key:1,class:"mb-6 p-4 bg-red-400/10 rounded-xl border border-red-400/30 text-red-400"},ae={key:2,class:"bg-light-bg-secondary dark:bg-gray-800/40 backdrop-blur-lg p-6 md:p-8 rounded-2xl border border-light-border dark:border-gray-700/30 shadow-xl relative z-[10]"},le={class:"flex gap-2"},oe={class:"relative flex-1"},se=["value"],de={class:"relative z-[999]"},ie={class:"block truncate"},ne={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2"},ue={class:"flex flex-col md:flex-row gap-4 justify-end"},ge=["disabled"],pe={key:0,class:"flex items-center justify-center"},be={key:1,class:"group-hover:translate-x-1 transition-transform"},ce={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50"},xe={class:"bg-light-bg-secondary dark:bg-gray-800/95 backdrop-blur-lg p-8 rounded-2xl border border-light-border dark:border-gray-700/30 shadow-2xl max-w-md w-full"},fe={class:"flex flex-col md:flex-row gap-4 justify-end"},ye=["disabled"],Se=A({__name:"TrackEditView",setup(me){const c=G(),o=L(),k=D(),v=I(),t=B({title:"",artist:"",icon:"",genre_id:"",price:0}),x=w(!1),g=w("");F(async()=>{if(await o.fetchGenres(),c.state.profile){const u=Number(v.params.id),e=await o.fetchTrack(c.state.profile.id,u);e?(t.title=e.title,t.artist=e.artist,t.icon=e.icon,t.genre_id=e.genre.id,t.price=e.price):await k.push("/tracks")}});async function C(){if(!c.state.profile||!o.currentTrack)return;if(!t.genre_id){o.error="Выберите жанр трека";return}const u=Number(v.params.id);await o.updateTrack(c.state.profile.id,u,{title:t.title,artist:t.artist,icon:t.icon,genre_id:Number(t.genre_id),price:Number(t.price)})&&await k.push("/tracks")}async function $(){if(g.value.trim()){const u=await o.createGenre(g.value.trim());u&&(t.genre_id=u.id,x.value=!1,g.value="")}}return(u,e)=>{const U=M("router-link");return d(),i("div",X,[s(H),r("main",Y,[r("div",Z,[e[16]||(e[16]=r("h1",{class:"text-3xl md:text-4xl font-bold mb-6 md:mb-10 bg-gradient-to-r from-purple-400 via-blue-400 to-cyan-400 bg-clip-text text-transparent animate-fade-in"}," Редактирование трека ",-1)),l(o).loading&&!l(o).currentTrack?(d(),i("div",ee,[r("div",re,[s(l(j),{class:"w-6 h-6 animate-spin-once"}),e[8]||(e[8]=r("span",null,"Загрузка данных...",-1))])])):l(o).error?(d(),i("div",te,y(l(o).error),1)):l(o).currentTrack?(d(),i("div",ae,[r("form",{onSubmit:_(C,["prevent"]),class:"space-y-6"},[r("div",null,[e[9]||(e[9]=r("label",{class:"block text-light-text-secondary dark:text-gray-400 mb-2"},"Название трека",-1)),p(r("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>t.title=a),required:"",class:"w-full p-3.5 bg-light-bg dark:bg-gray-900/20 border text-light-text dark:text-white border-light-border dark:border-gray-700/30 rounded-xl focus:border-purple-400/50 focus:ring-2 focus:ring-purple-400/20 transition-all placeholder-gray-500",placeholder:"Введите название"},null,512),[[b,t.title]])]),r("div",null,[e[10]||(e[10]=r("label",{class:"block text-light-text-secondary dark:text-gray-400 mb-2"},"Исполнитель",-1)),p(r("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=a=>t.artist=a),required:"",class:"w-full p-3.5 bg-light-bg dark:bg-gray-900/20 border text-light-text dark:text-white border-light-border dark:border-gray-700/30 rounded-xl focus:border-purple-400/50 focus:ring-2 focus:ring-purple-400/20 transition-all placeholder-gray-500",placeholder:"Введите исполнителя"},null,512),[[b,t.artist]])]),r("div",null,[e[11]||(e[11]=r("label",{class:"block text-light-text-secondary dark:text-gray-400 mb-2"},"Обложка трека",-1)),p(r("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=a=>t.icon=a),required:"",class:"w-full p-3.5 bg-light-bg dark:bg-gray-900/20 border text-light-text dark:text-white border-light-border dark:border-gray-700/30 rounded-xl focus:border-purple-400/50 focus:ring-2 focus:ring-purple-400/20 transition-all placeholder-gray-500",placeholder:"Ссылка на изображение"},null,512),[[b,t.icon]])]),r("div",null,[e[12]||(e[12]=r("label",{class:"block text-light-text-secondary dark:text-gray-400 mb-2"},"Жанр",-1)),r("div",le,[r("div",oe,[s(l(K),{modelValue:t.genre_id,"onUpdate:modelValue":e[3]||(e[3]=a=>t.genre_id=a),as:"div",class:"w-full"},{default:n(()=>[r("input",{type:"hidden",value:t.genre_id,required:""},null,8,se),r("div",de,[s(l(O),{class:"w-full pl-4 pr-10 py-3.5 text-left text-light-text dark:text-white bg-light-bg dark:bg-gray-900/20 border border-light-border dark:border-gray-700/30 rounded-xl focus:border-purple-400/50 focus:ring-2 focus:ring-purple-400/20 appearance-none transition-all placeholder-gray-500"},{default:n(()=>{var a;return[r("span",ie,y(t.genre_id?(a=l(o).genres.find(f=>f.id===Number(t.genre_id)))==null?void 0:a.name:"Выберите жанр"),1),r("span",ne,[s(l(P),{class:"h-5 w-5 text-light-text-secondary dark:text-gray-400","aria-hidden":"true"})])]}),_:1}),s(V,{"leave-active-class":"transition duration-100 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:n(()=>[s(l(Q),{class:"absolute z-[9999] mt-1 max-h-60 w-full overflow-auto rounded-xl bg-light-bg-secondary dark:bg-gray-800/95 backdrop-blur-lg py-1 text-base shadow-lg border border-light-border dark:border-gray-700/30 focus:outline-none"},{default:n(()=>[s(l(q),{value:"",disabled:"",class:"relative cursor-pointer select-none"},{default:n(({active:a,selected:f})=>[r("span",{class:T([a?"bg-purple-400/20 text-light-text dark:text-white":"text-light-text-secondary dark:text-gray-300","block truncate px-4 py-2"])}," Выберите жанр ",2)]),_:1}),(d(!0),i(E,null,R(l(o).genres,a=>(d(),N(l(q),{key:a.id,value:a.id,class:"relative cursor-pointer select-none"},{default:n(({active:f,selected:z})=>[r("span",{class:T([f?"bg-purple-400/20 text-light-text dark:text-white":"text-light-text-secondary dark:text-gray-300","block truncate px-4 py-2"])},[m(y(a.name)+" ",1),z?(d(),N(l(W),{key:0,class:"h-5 w-5 inline-block ml-2 text-purple-400","aria-hidden":"true"})):h("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])]),_:1},8,["modelValue"])]),r("button",{type:"button",onClick:e[4]||(e[4]=a=>x.value=!0),class:"p-3.5 bg-light-bg dark:bg-gray-900/20 hover:bg-purple-400/10 border border-light-border dark:border-gray-700/30 hover:border-purple-400/30 rounded-xl transition-all group"},[s(l(S),{class:"w-6 h-6 text-purple-400 group-hover:rotate-90 transition-transform"})])])]),r("div",null,[e[13]||(e[13]=r("label",{class:"block text-light-text-secondary dark:text-gray-400 mb-2"},"Цена",-1)),p(r("input",{type:"number","onUpdate:modelValue":e[5]||(e[5]=a=>t.price=a),min:"1",required:"",class:"w-full p-3.5 bg-light-bg dark:bg-gray-900/20 border text-light-text dark:text-white border-light-border dark:border-gray-700/30 rounded-xl focus:border-purple-400/50 focus:ring-2 focus:ring-purple-400/20 transition-all placeholder-gray-500",placeholder:"Стоимость в рублях"},null,512),[[b,t.price,void 0,{number:!0}]])]),r("div",ue,[s(U,{to:"/tracks",class:"px-6 py-3 text-light-text-secondary dark:text-gray-400 hover:text-light-text dark:hover:text-gray-200 transition-colors text-center"},{default:n(()=>e[14]||(e[14]=[m(" Отмена ")])),_:1}),r("button",{type:"submit",disabled:l(o).loading,class:"px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-500 border border-purple-400/20 rounded-xl font-semibold text-white hover:from-purple-700 hover:to-blue-600 transition-all disabled:opacity-50 group"},[l(o).loading?(d(),i("span",pe,[s(l(j),{class:"w-5 h-5 mr-2 animate-spin"}),e[15]||(e[15]=m(" Сохранение... "))])):(d(),i("span",be,"Обновить трек"))],8,ge)])],32)])):h("",!0)])]),s(V,{name:"fade"},{default:n(()=>[x.value?(d(),i("div",ce,[r("div",xe,[e[18]||(e[18]=r("h3",{class:"text-xl font-bold text-light-text dark:text-gray-200 mb-6 bg-gradient-to-r from-cyan-400/30 to-purple-400/30 w-max px-4 py-1 rounded-full"}," Новый жанр ",-1)),r("form",{onSubmit:_($,["prevent"]),class:"space-y-6"},[r("div",null,[e[17]||(e[17]=r("label",{class:"block text-light-text-secondary dark:text-gray-400 mb-2"},"Название жанра",-1)),p(r("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=a=>g.value=a),required:"",class:"w-full p-3.5 bg-light-bg dark:bg-gray-900/20 border text-light-text dark:text-white border-light-border dark:border-gray-700/30 rounded-xl focus:border-purple-400/50 focus:ring-2 focus:ring-purple-400/20 transition-all placeholder-gray-500",placeholder:"Введите название"},null,512),[[b,g.value]])]),r("div",fe,[r("button",{type:"button",onClick:e[7]||(e[7]=a=>x.value=!1),class:"px-6 py-3 bg-light-bg dark:bg-gray-700/10 hover:bg-light-bg-secondary dark:hover:bg-gray-700/20 border border-light-border dark:border-gray-700/30 text-light-text-secondary dark:text-gray-400 rounded-xl transition-all"}," Отмена "),r("button",{type:"submit",disabled:l(o).loading,class:"px-6 py-3 bg-gradient-to-r from-purple-600/30 to-blue-500/30 hover:from-purple-600/50 hover:to-blue-500/50 border border-purple-400/30 text-purple-400 rounded-xl transition-all disabled:opacity-50 group"},[s(l(S),{class:"w-5 h-5 mr-2 group-hover:rotate-90 transition-transform"}),m(" "+y(l(o).loading?"Создание...":"Создать"),1)],8,ye)])],32)])])):h("",!0)]),_:1}),s(J)])}}});export{Se as default};
