import{d as A,u as U,l as z,h as k,n as G,c as n,b as o,a as e,i as m,f as a,t as f,j as v,k as g,v as p,w as d,r as B,g as y,T as w,q as _,F,p as D,s as V,x as M,o as i}from"./index-DT03jyhA.js";import{u as I,r as N}from"./tracks-C4xg7Mxt.js";import{_ as E,c as L}from"./Footer.vue_vue_type_script_setup_true_lang-Bm2BFVvq.js";import{r as R}from"./ArrowPathIcon-C-Ojjxoq.js";import{I as H,j as J,r as K,A as O,F as S}from"./listbox-CfzWbYyL.js";import{r as P}from"./CheckIcon-qmlbtpli.js";import"./SunIcon-DNKNajIN.js";import"./CurrencyDollarIcon-CsVrdL4t.js";const Q={class:"min-h-screen bg-light-bg dark:bg-gray-900 flex flex-col"},W={class:"flex-1 container mx-auto px-4 py-8 md:py-12"},X={class:"max-w-2xl mx-auto"},Y={key:0,class:"mb-6 p-4 bg-red-400/10 rounded-xl border border-red-400/30 text-red-400"},Z={class:"flex gap-2"},ee={class:"relative flex-1"},re=["value"],te={class:"relative z-[999]"},le={class:"block truncate"},ae={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2"},oe={class:"flex flex-col md:flex-row gap-4 justify-end"},se=["disabled"],de={key:0,class:"flex items-center justify-center"},ie={key:1,class:"group-hover:translate-x-1 transition-transform"},ne={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50"},ue={class:"bg-light-bg-secondary dark:bg-gray-800/95 backdrop-blur-lg p-8 rounded-2xl border border-light-border dark:border-gray-700/30 shadow-2xl max-w-md w-full"},ge={class:"flex flex-col md:flex-row gap-4 justify-end"},pe=["disabled"],we=A({__name:"TrackAddView",setup(be){const h=U(),s=I(),j=M(),l=z({title:"",artist:"",icon:"",genre_id:"",price:100}),b=k(!1),u=k("");async function q(){if(!h.state.profile)return;if(!l.genre_id){s.error="Выберите жанр трека";return}await s.addTrack(h.state.profile.id,{...l,genre_id:Number(l.genre_id),price:Number(l.price)})&&await j.push("/tracks")}async function C(){if(u.value.trim()){const c=await s.createGenre(u.value.trim());c&&(l.genre_id=c.id,b.value=!1,u.value="")}}return G(async()=>{await s.fetchGenres()}),(c,r)=>{const T=B("router-link");return i(),n("div",Q,[o(E),e("main",W,[e("div",X,[r[15]||(r[15]=e("h1",{class:"text-3xl md:text-4xl font-bold mb-6 md:mb-10 bg-gradient-to-r from-purple-400 via-blue-400 to-cyan-400 bg-clip-text text-transparent animate-fade-in"}," Добавление трека ",-1)),a(s).error?(i(),n("div",Y,f(a(s).error),1)):m("",!0),e("form",{onSubmit:v(q,["prevent"]),class:"bg-light-bg-secondary dark:bg-gray-800/40 backdrop-blur-lg p-6 md:p-8 rounded-2xl border border-light-border dark:border-gray-700/30 shadow-xl space-y-6 relative z-[10]"},[e("div",null,[r[8]||(r[8]=e("label",{class:"block text-light-text-secondary dark:text-gray-400 mb-2"},"Название трека",-1)),g(e("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=t=>l.title=t),required:"",class:"w-full p-3.5 bg-light-bg dark:bg-gray-900/20 border text-light-text dark:text-white border-light-border dark:border-gray-700/30 rounded-xl focus:border-purple-400/50 focus:ring-2 focus:ring-purple-400/20 transition-all placeholder-gray-500",placeholder:"Введите название"},null,512),[[p,l.title]])]),e("div",null,[r[9]||(r[9]=e("label",{class:"block text-light-text-secondary dark:text-gray-400 mb-2"},"Исполнитель",-1)),g(e("input",{type:"text","onUpdate:modelValue":r[1]||(r[1]=t=>l.artist=t),required:"",class:"w-full p-3.5 bg-light-bg dark:bg-gray-900/20 border text-light-text dark:text-white border-light-border dark:border-gray-700/30 rounded-xl focus:border-purple-400/50 focus:ring-2 focus:ring-purple-400/20 transition-all placeholder-gray-500",placeholder:"Введите исполнителя"},null,512),[[p,l.artist]])]),e("div",null,[r[10]||(r[10]=e("label",{class:"block text-light-text-secondary dark:text-gray-400 mb-2"},"Обложка трека",-1)),g(e("input",{type:"text","onUpdate:modelValue":r[2]||(r[2]=t=>l.icon=t),required:"",class:"w-full p-3.5 bg-light-bg dark:bg-gray-900/20 border text-light-text dark:text-white border-light-border dark:border-gray-700/30 rounded-xl focus:border-purple-400/50 focus:ring-2 focus:ring-purple-400/20 transition-all placeholder-gray-500",placeholder:"Ссылка на изображение"},null,512),[[p,l.icon]])]),e("div",null,[r[11]||(r[11]=e("label",{class:"block text-light-text-secondary dark:text-gray-400 mb-2"},"Жанр",-1)),e("div",Z,[e("div",ee,[o(a(H),{modelValue:l.genre_id,"onUpdate:modelValue":r[3]||(r[3]=t=>l.genre_id=t),as:"div",class:"w-full"},{default:d(()=>[e("input",{type:"hidden",value:l.genre_id,required:""},null,8,re),e("div",te,[o(a(J),{class:"w-full pl-4 pr-10 py-3.5 text-left text-light-text dark:text-white bg-light-bg dark:bg-gray-900/20 border border-light-border dark:border-gray-700/30 rounded-xl focus:border-purple-400/50 focus:ring-2 focus:ring-purple-400/20 appearance-none transition-all placeholder-gray-500"},{default:d(()=>{var t;return[e("span",le,f(l.genre_id?(t=a(s).genres.find(x=>x.id===Number(l.genre_id)))==null?void 0:t.name:"Выберите жанр"),1),e("span",ae,[o(a(K),{class:"h-5 w-5 text-light-text-secondary dark:text-gray-400","aria-hidden":"true"})])]}),_:1}),o(w,{"leave-active-class":"transition duration-100 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:d(()=>[o(a(O),{class:"absolute z-[9999] mt-1 max-h-60 w-full overflow-auto rounded-xl bg-light-bg-secondary dark:bg-gray-800/95 backdrop-blur-lg py-1 text-base shadow-lg border border-light-border dark:border-gray-700/30 focus:outline-none"},{default:d(()=>[o(a(S),{value:"",disabled:"",class:"relative cursor-pointer select-none"},{default:d(({active:t,selected:x})=>[e("span",{class:_([t?"bg-purple-400/20 text-light-text dark:text-white":"text-light-text-secondary dark:text-gray-300","block truncate px-4 py-2"])}," Выберите жанр ",2)]),_:1}),(i(!0),n(F,null,D(a(s).genres,t=>(i(),V(a(S),{key:t.id,value:t.id,class:"relative cursor-pointer select-none"},{default:d(({active:x,selected:$})=>[e("span",{class:_([x?"bg-purple-400/20 text-light-text dark:text-white":"text-light-text-secondary dark:text-gray-300","block truncate px-4 py-2"])},[y(f(t.name)+" ",1),$?(i(),V(a(P),{key:0,class:"h-5 w-5 inline-block ml-2 text-purple-400","aria-hidden":"true"})):m("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])]),_:1},8,["modelValue"])]),e("button",{type:"button",onClick:r[4]||(r[4]=t=>b.value=!0),class:"p-3.5 bg-light-bg dark:bg-gray-900/20 hover:bg-purple-400/10 border border-light-border dark:border-gray-700/30 hover:border-purple-400/30 rounded-xl transition-all group"},[o(a(N),{class:"w-6 h-6 text-purple-400 group-hover:rotate-90 transition-transform"})])])]),e("div",null,[r[12]||(r[12]=e("label",{class:"block text-light-text-secondary dark:text-gray-400 mb-2"},"Цена",-1)),g(e("input",{type:"number","onUpdate:modelValue":r[5]||(r[5]=t=>l.price=t),min:"1",required:"",class:"w-full p-3.5 bg-light-bg dark:bg-gray-900/20 border text-light-text dark:text-white border-light-border dark:border-gray-700/30 rounded-xl focus:border-purple-400/50 focus:ring-2 focus:ring-purple-400/20 transition-all placeholder-gray-500",placeholder:"Стоимость в рублях"},null,512),[[p,l.price,void 0,{number:!0}]])]),e("div",oe,[o(T,{to:"/tracks",class:"px-6 py-3 text-light-text-secondary dark:text-gray-400 hover:text-light-text dark:hover:text-gray-200 transition-colors text-center"},{default:d(()=>r[13]||(r[13]=[y(" Отмена ")])),_:1}),e("button",{type:"submit",disabled:a(s).loading,class:"px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-500 border border-purple-400/20 rounded-xl font-semibold text-white hover:from-purple-700 hover:to-blue-600 transition-all disabled:opacity-50 group"},[a(s).loading?(i(),n("span",de,[o(a(R),{class:"w-5 h-5 mr-2 animate-spin"}),r[14]||(r[14]=y(" Добавление... "))])):(i(),n("span",ie,"Создать трек"))],8,se)])],32)])]),o(w,{name:"fade"},{default:d(()=>[b.value?(i(),n("div",ne,[e("div",ue,[r[17]||(r[17]=e("h3",{class:"text-xl font-bold text-light-text dark:text-gray-200 mb-6 bg-gradient-to-r from-cyan-400/30 to-purple-400/30 w-max px-4 py-1 rounded-full"}," Новый жанр ",-1)),e("form",{onSubmit:v(C,["prevent"]),class:"space-y-6"},[e("div",null,[r[16]||(r[16]=e("label",{class:"block text-light-text-secondary dark:text-gray-400 mb-2"},"Название жанра",-1)),g(e("input",{type:"text","onUpdate:modelValue":r[6]||(r[6]=t=>u.value=t),required:"",class:"w-full p-3.5 bg-light-bg dark:bg-gray-900/20 border text-light-text dark:text-white border-light-border dark:border-gray-700/30 rounded-xl focus:border-purple-400/50 focus:ring-2 focus:ring-purple-400/20 transition-all placeholder-gray-500",placeholder:"Введите название"},null,512),[[p,u.value]])]),e("div",ge,[e("button",{type:"button",onClick:r[7]||(r[7]=t=>b.value=!1),class:"px-6 py-3 bg-light-bg dark:bg-gray-700/10 hover:bg-light-bg-secondary dark:hover:bg-gray-700/20 border border-light-border dark:border-gray-700/30 text-light-text-secondary dark:text-gray-400 rounded-xl transition-all"}," Отмена "),e("button",{type:"submit",disabled:a(s).loading,class:"px-6 py-3 bg-gradient-to-r from-purple-600/30 to-blue-500/30 hover:from-purple-600/50 hover:to-blue-500/50 border border-purple-400/30 text-purple-400 rounded-xl transition-all disabled:opacity-50 group"},[o(a(N),{class:"w-5 h-5 mr-2 group-hover:rotate-90 transition-transform"}),y(" "+f(a(s).loading?"Создание...":"Создать"),1)],8,pe)])],32)])])):m("",!0)]),_:1}),o(L)])}}});export{we as default};
